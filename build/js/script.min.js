"use strict";window.util={getRandomColor:function(){let t=Math.floor(128),o=Math.floor(256*Math.random()),r=Math.floor(256*Math.random());return"#"+t.toString(16)+o.toString(16)+r.toString(16)}};
class Gamer{constructor(o,s){this.name=o,this.color=s,this.moveCount=0}}
"use strict";const ROW_COUNT=10,COLUMN_COUNT=10,GAMER_COUNT=2,NAME_PREFIX="Gamer",plaingArea=document.querySelector(".playing-area"),congratulationsModal=document.querySelector(".congratulations-modal"),gamerTemplate=document.querySelector("#gamer").content.querySelector(".game__gamer"),gamerBoard=document.querySelector(".game__participants"),buttonRestart=document.querySelector(".congratulations-modal__button-yes"),buttonNoRestart=document.querySelector(".congratulations-modal__button-no"),WIN_COMBINATION=5,WIN_DETECTED=1e3;let gamers=new Array,currentGamer=0,board=[];function closeModal(){congratulationsModal.classList.remove("congratulations-modal--show")}function restartGame(){for(let e=0;e<10;e++)for(let t=0;t<10;t++){let r={td:board[e][t].cellObj.td,x:e,y:t},a=onCellClick.bind(r);board[e][t].cellObj.td.style.background="",board[e][t].cellObj.td.addEventListener("click",a),board[e][t]={cellObj:r,cellHandler:a};for(let r=board[e][t].cellObj.td.classList.length-1;r>0;r--){gamers.some((function(a){return a.name==board[e][t].cellObj.td.classList[r]}))&&board[e][t].cellObj.td.classList.remove(board[e][t].cellObj.td.classList[r])}}for(let e=0;e<gamers.length;e++)gamers[e].moveCount=0,updateUserBoard();congratulationsModal.classList.remove("congratulations-modal--show")}function createGamer(e,t,r){let a=gamerTemplate.cloneNode(!0);for(let n=0;n<a.children.length;n++)a.children[n].classList.contains("game__gamer-name")&&(a.children[n].textContent=e),a.children[n].classList.contains("game__gamer-score")&&(a.children[n].textContent=r),a.style.background=t;gamerBoard.appendChild(a)}function onCellClick(){if(this.td.classList.add("playing-area__cell--disable"),this.td.classList.add(gamers[currentGamer].name),this.td.style.background=gamers[currentGamer].color,this.td.removeEventListener("click",board[this.x][this.y].cellHandler),gamers[currentGamer].moveCount++,updateUserBoard(),checkWin(board,this.x,this.y))return startFreezing(),void showWinModal(gamers[currentGamer].name);currentGamer+1>=gamers.length?currentGamer=0:currentGamer++,currentGamer>0&&artificialIntelligenceRun()}function updateUserBoard(){let e=gamerBoard.querySelectorAll(".game__gamer");for(let t=e.length-1;t>=0;t--)e[t].remove();for(let e=0;e<gamers.length;e++)createGamer(gamers[e].name,gamers[e].color,gamers[e].moveCount)}function artificialIntelligenceRun(){let e={x:0,y:0,evaluate:0};for(let t=0;t<10;t++)for(let r=0;r<10;r++){let a=evaluateMove(board,t,r,gamers[currentGamer]);e.evaluate<a&&(e.evaluate=a,e.x=t,e.y=r,e.td=board[t][r].cellObj.td)}onCellClick.bind(e)()}function startFreezing(){for(let e=0;e<10;e++)for(let t=0;t<10;t++)board[e][t].cellObj.td.removeEventListener("click",board[e][t].cellHandler)}function showWinModal(e){congratulationsModal.classList.add("congratulations-modal--show"),congratulationsModal.querySelector(".congratulations-modal__gamer").textContent=e}function checkWin(e,t,r){const a=getDirections(e,t,r);for(let e=0;e<4;e++)if(checkDirections(a[e]))return!0}function getDirections(e,t,r){const a=[[],[],[],[]];for(let n=-4;n<5;n++)t+n>=0&&t+n<=9&&(a[0].push(e[t+n][r]),r+n>=0&&r+n<=9&&a[2].push(e[t+n][r+n])),r+n>=0&&r+n<=9&&(a[1].push(e[t][r+n]),t-n>=0&&t-n<=9&&a[3].push(e[t-n][r+n]));return a}function checkDirections(e){for(let t=0;t<e.length-5+1;t++)if(e[t].cellObj.td.classList.contains(gamers[currentGamer].name)&&e[t+1].cellObj.td.classList.contains(gamers[currentGamer].name)&&e[t+2].cellObj.td.classList.contains(gamers[currentGamer].name)&&e[t+3].cellObj.td.classList.contains(gamers[currentGamer].name)&&e[t+4].cellObj.td.classList.contains(gamers[currentGamer].name))return!0}function evaluateMove(e,t,r,a){if(!gamers.every((function(a){return!e[t][r].cellObj.td.classList.contains(a.name)})))return 0;let n=0;const l=getDirections(e,t,r);let o;for(let e=0;e<4;e++){if(o=evaluateDirection(l[e],a),1e3===o)return 1e3;n+=o}return n}function evaluateDirection(e,t){let r=0;for(let a=0;a+4<e.length;a++){let n=0,l=0;for(let r=0;r<=4;r++){let o=gamers.slice(1).some((function(t){return e[a+r].cellObj.td.classList.contains(t.name)})),c=e[a+r].cellObj.td.classList.contains(t.name);o?n++:c&&l++}if(r+=evalff(getSeq(n,l)),r>=8e5)return 1e3}return r}function evalff(e){switch(e){case 0:return 7;case 1:return 35;case 2:return 800;case 3:return 15e3;case 4:return 8e5;case-1:return 15;case-2:return 400;case-3:return 1800;case-4:return 1e5;case 17:return 0}}function getSeq(e,t){return e+t===0?0:0!==e&&0===t?e:0===e&&0!==t?-t:0!==e&&0!==t?17:void 0}!function(){for(let e=0;e<10;e++){let t=document.createElement("tr");board[e]=[];for(let r=0;r<10;r++){let a=document.createElement("td");a.classList.add("playing-area__cell");let n={td:a,x:e,y:r},l=onCellClick.bind(n);a.addEventListener("click",l),t.appendChild(a),board[e][r]={cellObj:n,cellHandler:l}}plaingArea.appendChild(t)}for(let e=0;e<2;e++){let t=`Gamer${e}`;0==e&&(t="You");let r=window.util.getRandomColor();createGamer(t,r,0),gamers.push(new Gamer(t,r))}buttonRestart.addEventListener("click",restartGame),buttonNoRestart.addEventListener("click",closeModal)}();
const rowInput=document.querySelector(".form__row-count"),columnInput=document.querySelector(".form__column-count"),coordinateTable=document.querySelector(".coordinate-table"),cellTemplate=document.querySelector("#coordinate-table-data").content.querySelector(".coordinate-table__cell"),cellTitleTemplate=document.querySelector("#coordinate-table-data").content.querySelector(".coordinate-table__title"),radioItems=document.querySelectorAll(".tabs__element-radio"),tabsItems=document.querySelectorAll(".tabs__item");let chart=[];function hideTab(){for(let e=0;e<radioItems.length;e++)radioItems[e].checked?tabsItems[e].classList.remove("visually-hidden"):tabsItems[e].classList.add("visually-hidden")}function drowTable(){let e=rowInput.value-coordinateTable.rows.length+1,t=columnInput.value-coordinateTable.rows[coordinateTable.rows.length-1].cells.length+1;if(Math.abs(e)>0)for(let t=0;t<Math.abs(e);t++)e>0?addRowTable():removeRowTable();if(Math.abs(t)>0)for(let e=0;e<Math.abs(t);e++)t>0?addColumnTable():removeColumnTable();reDrowTable()}function reDrowTable(){fillChartArray(),google.charts.setOnLoadCallback(drawChart)}columnInput.addEventListener("change",drowTable),rowInput.addEventListener("change",drowTable),radioItems.forEach((e=>{e.addEventListener("change",hideTab)}));const transpose=e=>e[0].map(((t,o)=>e.map((e=>e[o]))));function fillChartArray(){for(let e=0;e<coordinateTable.rows.length;e++){chart[e]=[];for(let t=0;t<coordinateTable.rows[e].cells.length;t++)0==t||0==e?chart[e].push(coordinateTable.rows[e].cells[t].textContent.trim()):chart[e].push(parseInt(coordinateTable.rows[e].cells[t].children[0].value))}}function addRowTable(){let e=document.createElement("tr");for(let t=0;t<coordinateTable.rows[coordinateTable.rows.length-1].cells.length;t++)if(0===t){let t=cellTitleTemplate.cloneNode(!0);t.textContent=`День ${coordinateTable.rows.length}`,e.appendChild(t)}else{let t=cellTemplate.cloneNode(!0);t.children[0].addEventListener("input",reDrowTable),e.appendChild(t)}coordinateTable.appendChild(e)}function addColumnTable(){for(let e=0;e<coordinateTable.rows.length;e++)if(0==e){let t=cellTitleTemplate.cloneNode(!0);t.textContent=`Час ${coordinateTable.rows[0].cells.length}`,coordinateTable.rows[e].appendChild(t)}else{let t=cellTemplate.cloneNode(!0);t.children[0].addEventListener("input",reDrowTable),coordinateTable.rows[e].appendChild(t)}}function removeRowTable(){coordinateTable.rows[coordinateTable.rows.length-1].remove()}function removeColumnTable(){for(let e=0;e<coordinateTable.rows.length;e++)coordinateTable.rows[e].cells[coordinateTable.rows[e].cells.length-1].remove()}function drawChart(){var e,t=google.visualization.arrayToDataTable((e=chart)[0].map(((t,o)=>e.map((e=>e[o])))));new google.visualization.AreaChart(document.querySelector(".drow-area__graph")).draw(t,{title:"Анализатор погоды",hAxis:{title:"Время",titleTextStyle:{color:"#333"}},vAxis:{title:"Температура",minValue:0}})}google.charts.load("current",{packages:["corechart"]});